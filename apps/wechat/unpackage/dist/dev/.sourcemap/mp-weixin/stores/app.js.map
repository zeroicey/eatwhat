{"version":3,"file":"app.js","sources":["stores/app.js"],"sourcesContent":["import { defineStore } from 'pinia'\n\n/**\n * App Store - 应用全局状态管理\n * 职责：全局 UI 状态、网络状态、系统信息\n * 持久化：运行时内存，不持久化\n */\nexport const useAppStore = defineStore('app', {\n  state: () => ({\n    // 全局加载状态\n    loading: false,\n    // 加载文本\n    loadingText: 'Loading...',\n    // Toast 消息队列\n    toasts: [],\n    // Modal 显示状态\n    modal: {\n      visible: false,\n      title: '',\n      content: '',\n      confirmText: 'Confirm',\n      cancelText: 'Cancel',\n      onConfirm: null,\n      onCancel: null\n    },\n    // 网络状态\n    networkType: 'unknown',\n    isOnline: true,\n    // 系统信息\n    systemInfo: null,\n    // 当前页面路径\n    currentPage: ''\n  }),\n\n  getters: {\n    /**\n     * 是否有 Toast 消息\n     */\n    hasToast: (state) => state.toasts.length > 0,\n\n    /**\n     * 获取最新的 Toast 消息\n     */\n    latestToast: (state) => {\n      return state.toasts.length > 0 ? state.toasts[0] : null\n    }\n  },\n\n  actions: {\n    /**\n     * 显示全局加载\n     * @param {String} text - 加载提示文本\n     */\n    showLoading(text = 'Loading...') {\n      this.loading = true\n      this.loadingText = text\n      uni.showLoading({\n        title: text,\n        mask: true\n      })\n    },\n\n    /**\n     * 隐藏全局加载\n     */\n    hideLoading() {\n      this.loading = false\n      uni.hideLoading()\n    },\n\n    /**\n     * 显示 Toast 提示\n     * @param {Object} options - { message, type, duration }\n     */\n    showToast({ message, type = 'none', duration = 2000 }) {\n      const toast = {\n        id: Date.now(),\n        message,\n        type, // success, error, warning, info, none\n        duration\n      }\n\n      this.toasts.push(toast)\n\n      // 显示 Toast\n      uni.showToast({\n        title: message,\n        icon: type === 'success' ? 'success' : type === 'error' ? 'error' : 'none',\n        duration\n      })\n\n      // 自动移除\n      setTimeout(() => {\n        this.removeToast(toast.id)\n      }, duration)\n    },\n\n    /**\n     * 移除 Toast\n     * @param {Number} id - Toast ID\n     */\n    removeToast(id) {\n      this.toasts = this.toasts.filter(t => t.id !== id)\n    },\n\n    /**\n     * 显示确认对话框\n     * @param {Object} options - { title, content, confirmText, cancelText, onConfirm, onCancel }\n     */\n    showModal(options) {\n      this.modal = {\n        visible: true,\n        title: options.title || '',\n        content: options.content || '',\n        confirmText: options.confirmText || 'Confirm',\n        cancelText: options.cancelText || 'Cancel',\n        onConfirm: options.onConfirm || null,\n        onCancel: options.onCancel || null\n      }\n\n      uni.showModal({\n        title: this.modal.title,\n        content: this.modal.content,\n        confirmText: this.modal.confirmText,\n        cancelText: this.modal.cancelText,\n        success: (res) => {\n          if (res.confirm && this.modal.onConfirm) {\n            this.modal.onConfirm()\n          } else if (res.cancel && this.modal.onCancel) {\n            this.modal.onCancel()\n          }\n          this.hideModal()\n        }\n      })\n    },\n\n    /**\n     * 隐藏对话框\n     */\n    hideModal() {\n      this.modal.visible = false\n    },\n\n    /**\n     * 更新网络状态\n     * @param {Object} info - { networkType, isConnected }\n     */\n    updateNetworkStatus(info) {\n      this.networkType = info.networkType\n      this.isOnline = info.isConnected\n    },\n\n    /**\n     * 监听网络状态变化\n     */\n    watchNetworkStatus() {\n      // 获取当前网络状态\n      uni.getNetworkType({\n        success: (res) => {\n          this.updateNetworkStatus({\n            networkType: res.networkType,\n            isConnected: res.networkType !== 'none'\n          })\n        }\n      })\n\n      // 监听网络状态变化\n      uni.onNetworkStatusChange((res) => {\n        this.updateNetworkStatus({\n          networkType: res.networkType,\n          isConnected: res.isConnected\n        })\n\n        // 网络断开时提示\n        if (!res.isConnected) {\n          this.showToast({\n            message: 'Network disconnected',\n            type: 'error'\n          })\n        }\n      })\n    },\n\n    /**\n     * 获取系统信息\n     */\n    getSystemInfo() {\n      uni.getSystemInfo({\n        success: (res) => {\n          this.systemInfo = res\n        }\n      })\n    },\n\n    /**\n     * 更新当前页面路径\n     * @param {String} path - 页面路径\n     */\n    setCurrentPage(path) {\n      this.currentPage = path\n    }\n  }\n})\n"],"names":["defineStore","uni"],"mappings":"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"}