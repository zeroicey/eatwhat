{"version":3,"file":"app.js","sources":["App.vue","main.js"],"sourcesContent":["<script setup>\r\nimport { onLaunch, onShow, onHide } from '@dcloudio/uni-app'\r\nimport { useUserStore } from '@/stores/user'\r\nimport { useAppStore } from '@/stores/app'\r\n\r\nconst userStore = useUserStore()\r\nconst appStore = useAppStore()\r\n\r\nonLaunch(() => {\r\n  console.log('App Launch')\r\n  \r\n  // 获取系统信息\r\n  appStore.getSystemInfo()\r\n  \r\n  // 监听网络状态\r\n  appStore.watchNetworkStatus()\r\n  \r\n  // 恢复用户 Token\r\n  userStore.restoreToken()\r\n  \r\n  // 检查认证状态\r\n  if (!userStore.checkAuth()) {\r\n    // 未登录，跳转到登录页\r\n    // 注意：小程序首次启动可能需要先进入首页再引导登录\r\n    console.log('User not authenticated')\r\n  }\r\n})\r\n\r\nonShow(() => {\r\n  console.log('App Show')\r\n  \r\n  // 检查 Token 是否过期\r\n  if (userStore.isLoggedIn && userStore.isTokenExpired) {\r\n    userStore.logout()\r\n    uni.showToast({\r\n      title: 'Login expired, please login again',\r\n      icon: 'none'\r\n    })\r\n  }\r\n})\r\n\r\nonHide(() => {\r\n  console.log('App Hide')\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n@import './styles/common.scss';\r\n@import './styles/theme.scss';\r\n\r\n/* 每个页面公共 CSS */\r\npage {\r\n  height: 100%;\r\n}\r\n</style>\r\n","import App from './App'\r\nimport { createSSRApp } from 'vue'\r\nimport { createPinia } from 'pinia'\r\nimport { VueQueryPlugin } from '@tanstack/vue-query'\r\n\r\n// 导入公共样式\r\nimport './styles/common.scss'\r\nimport './styles/theme.scss'\r\n\r\nexport function createApp() {\r\n  const app = createSSRApp(App)\r\n\r\n  // 配置 Pinia\r\n  const pinia = createPinia()\r\n  app.use(pinia)\r\n\r\n  // 配置 Vue Query - 暂时注释，需要先安装依赖\r\n  app.use(VueQueryPlugin, {\r\n    queryClientConfig: {\r\n      defaultOptions: {\r\n        queries: {\r\n          staleTime: 5 * 60 * 1000, // 5分钟\r\n          cacheTime: 10 * 60 * 1000, // 10分钟\r\n          refetchOnWindowFocus: true,\r\n          retry: 3,\r\n          retryDelay: (attemptIndex) => Math.min(1000 * 2 ** attemptIndex, 30000)\r\n        }\r\n      }\r\n    }\r\n  })\r\n\r\n  return {\r\n    app,\r\n    pinia\r\n  }\r\n}\r\n"],"names":["useUserStore","useAppStore","onLaunch","uni","onShow","onHide","createSSRApp","App","createPinia","VueQueryPlugin"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAKA,UAAM,YAAYA,YAAAA,aAAc;AAChC,UAAM,WAAWC,WAAAA,YAAa;AAE9BC,kBAAAA,SAAS,MAAM;AACbC,oBAAAA,MAAA,MAAA,OAAA,iBAAY,YAAY;AAGxB,eAAS,cAAe;AAGxB,eAAS,mBAAoB;AAG7B,gBAAU,aAAc;AAGxB,UAAI,CAAC,UAAU,aAAa;AAG1BA,sBAAAA,MAAA,MAAA,OAAA,iBAAY,wBAAwB;AAAA,MACrC;AAAA,IACH,CAAC;AAEDC,kBAAAA,OAAO,MAAM;AACXD,oBAAAA,MAAA,MAAA,OAAA,iBAAY,UAAU;AAGtB,UAAI,UAAU,cAAc,UAAU,gBAAgB;AACpD,kBAAU,OAAQ;AAClBA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AAAA,MACF;AAAA,IACH,CAAC;AAEDE,kBAAAA,OAAO,MAAM;AACXF,oBAAAA,MAAA,MAAA,OAAA,iBAAY,UAAU;AAAA,IACxB,CAAC;;;;;AClCM,SAAS,YAAY;AAC1B,QAAM,MAAMG,cAAY,aAACC,SAAG;AAG5B,QAAM,QAAQC,cAAAA,YAAa;AAC3B,MAAI,IAAI,KAAK;AAGb,MAAI,IAAIC,8BAAgB;AAAA,IACtB,mBAAmB;AAAA,MACjB,gBAAgB;AAAA,QACd,SAAS;AAAA,UACP,WAAW,IAAI,KAAK;AAAA;AAAA,UACpB,WAAW,KAAK,KAAK;AAAA;AAAA,UACrB,sBAAsB;AAAA,UACtB,OAAO;AAAA,UACP,YAAY,CAAC,iBAAiB,KAAK,IAAI,MAAO,KAAK,cAAc,GAAK;AAAA,QACvE;AAAA,MACF;AAAA,IACF;AAAA,EACL,CAAG;AAED,SAAO;AAAA,IACL;AAAA,IACA;AAAA,EACD;AACH;AAEA,YAAY,IAAI,MAAM,MAAM;;"}